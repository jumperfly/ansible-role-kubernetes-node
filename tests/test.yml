- hosts: ca_nodes
  become: yes
  environment:
    PATH: /usr/local/bin:{{ ansible_env.PATH }}
  roles:
  - jumperfly.root_ca
  tags:
  - ca
  - generate-certs
  - generate-certs-kube
- hosts: ca_nodes
  become: yes
  environment:
    PATH: /usr/local/bin:{{ ansible_env.PATH }}
  roles:
  - role: jumperfly.ssl_cert
    ssl_cert_type: intermediate
    ssl_cert_name: etcd-ca
  - role: jumperfly.ssl_cert
    ssl_cert_type: intermediate
    ssl_cert_name: kubernetes-ca
  tags:
  - ca
  - generate-certs
  - generate-certs-kube
- hosts: kube_master_nodes
  become: yes
  environment:
    PATH: /usr/local/bin:{{ ansible_env.PATH }}
  roles:
  - jumperfly.kubernetes_master
  tags:
  - kube
  - kube-master
- hosts: kube_nodes
  become: yes
  environment:
    PATH: /usr/local/bin:{{ ansible_env.PATH }}
  roles:
  - jumperfly.kubernetes_node
- hosts: kube_master_nodes,kube_nodes
  become: yes
  environment:
    PATH: /usr/local/bin:{{ ansible_env.PATH }}
  roles:
  - jumperfly.flannel
  tags:
  - flannel
- hosts: kube_master_nodes[0]
  become: yes
  environment:
    PATH: /usr/local/bin:{{ ansible_env.PATH }}
  roles:
  - jumperfly.coredns
  tags:
  - coredns
